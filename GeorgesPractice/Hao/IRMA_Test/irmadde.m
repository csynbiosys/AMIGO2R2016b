% function out= def(K)
% 
% K=K/1000;
% init = [0.0031    0.0128    0.0027    0.0087    0.0089];
% options=[];
% sol = dde23(@quasi_delay, [100] ,init',[0 12000], options);
% out=[sol.x;sol.y]';

    
    function dy = irmadde(t,y,Z,par,u)
g=1*10^-2;
a=1000;
b=0.1;


% parametri 1
%K=[1884   30000  52.3  229.4    14606    180    2855    160   14000    160.28    9748.4    64800    33000    103.15    1161.5   637.8    3.6    16.73    1512    1.92    0    24    19.6    7.2    0  989.69    1e+005    800    1000    1000]/1000;


% parametri2

%K=[1.884    30    0.0523    0.2294    14.606    0.216    2.855   0.16    19.6    0.16028    9.7484    77.76    39.6    0.10315   1.1615    0.6378    0.00288    0.01673    1.512    0.00192    0   0.0384    0.0196    0.0072    0    0.98969    100    0.8    1    1];

%K=[58.27 2371.14 52.3 4968.23 6675.5 331.79 2855 6240.55  32397.2 90.33 13433.4 77760 59740.2 149.94 1161.5 326.57 4.54 4.08 98.72 3.31 0 38.4 19.6 3.88 0 1683.4 15015 1289.35   1316.15 649.48]\1000;
K=par;
%CBF1
dy(1,1) = K(16)*( K(14)* (Z(3)^K(26)/( (K(1)^K(26)+Z(3)^K(26)) *( 1+(y (5)^K(29)/K(2) ) ) ) )  - K(3)*y(1) + K(21)); %*( (sign(t-1120)+1)/2 )

%GAL4
dy(2,1) = K(17)*(K(30)*(y(1) /(K(4)+y(1)) ) -  (K(5)- (K(12)*( (sign (t-3000)-1)/2 - (sign(t-3010)-1)/2) ) ) *y(2)+ K(22));
%dy(2,1) = K(17)*(K(30)*(y(1) /(K(4)+y(1)) ) -  (K(5)  +  (K(12)*((sign(t-10)-1)/2) ) ) *y(2)+ K(22));
%SWI5

dy(3,1) =K(18)*( K(19)*(y(2)/ ( (1+ ((K(27)*y(4))/(g+u)) ) * ( K(6)+y(2) )  )  ) - K(7)*y(3)+ K(23) );

%GAL80


dy(4,1) =K(24)*((y(3)^K(28)/(K(8)^K(28)+y(3)^K(28)) )- (K(9) - (K(13)* ( (sign(t-3000)-1)/2- (sign(t-3010)-1)/2 ) )  )*y(4)+ K(25)) ;


%dy(4,1) =K(24)*((y(3)^K(28)/(K(8)^K(28)+y(3)^K(28)) )- (K(9) +  (K(13)* ( (sign(t-10)-1)/2)  ))*y(4)+ K(25)) ;



%con ho promoter davanti a gal80
%dy(4,1) =K(24)*(K(14)* (Z(3)^K(26)/( (K(1)^K(26)+Z(3)^K(26)) *( 1+(y (5)^K(29)/K(2) ) ) ) )- (K(9) - (K(13)*( (sign(t-3000)-1)/2- (sign(t-3010)-1)/2  + 0*(sign (t-7000)-1)/2 - 0*(sign(t-7010)-1)/2 ) ))*y(4)+ K(25)) ;

%ASH1
dy(5,1) =K(20)*( K(15)*(y(3)^K(28)/(K(10)^K(28)+y(3)^K(28)))-K(11)*y (5)+ K(22));

end
%end

